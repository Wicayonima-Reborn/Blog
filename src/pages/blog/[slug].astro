---
import BaseLayout from "../../layouts/BaseLayout.astro";
import Header from "../../components/Header.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const posts = await getCollection("blog");

  return posts.map((post) => ({
    params: { slug: post.id },
    props: { post },
  }));
}

const { post } = Astro.props;

// Astro 5: body = HTML string
const html = post.body;
---

<BaseLayout title={post.data.title}>
  <Header />

  <main>
    <article>
      <h1>{post.data.title}</h1>

      {post.data.description && (
        <p class="desc">{post.data.description}</p>
      )}

      <p class="date">
        {post.data.pubDate.toDateString()}
      </p>

      <div class="content" set:html={html} />
    </article>
  </main>

  <style>
    article {
      max-width: 720px;
      margin: 0 auto;
    }

    .desc {
      color: var(--muted);
      margin-bottom: 0.25rem;
    }

    .date {
      font-size: 0.85rem;
      color: var(--muted);
      margin-bottom: 1.5rem;
    }

    .content p {
      line-height: 1.7;
      margin-bottom: 1rem;
    }

    .content pre {
      background: #161b22;
      padding: 1rem;
      border-radius: 8px;
      overflow-x: auto;
    }
  </style>
</BaseLayout>